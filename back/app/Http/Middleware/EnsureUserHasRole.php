<?php\n\nnamespace App\Http\Middleware;\n\nuse Closure;\nuse Illuminate\Http\Request;\n\nclass EnsureUserHasRole\n{\n    public function handle(Request $request, Closure $next, string $role)\n    {\n        if (! $request->user() || ! method_exists($request->user(), 'hasRole') || ! $request->user()->hasRole($role)) {\n            abort(403, 'ACCESS DENIED');\n        }\n        return $next($request);\n    }\n}\n